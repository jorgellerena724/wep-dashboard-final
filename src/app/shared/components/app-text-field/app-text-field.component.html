<div class="relative mb-4">
  <div class="relative">
    <!-- Texto est치tico encima del campo -->
    <div class="text-black text-sm mb-1 dark:text-[rgb(209,213,219)] font-bold">
      {{ placeholder() || label() }}
    </div>

    <!-- Input normal (cuando no es textarea) -->
    @if (!isTextArea()) {
    <input
      #input
      [id]="id()"
      [maxlength]="maxLength() || (formatCard() ? 19 : null)"
      (input)="formatCard() ? onCardInput($event) : null"
      [min]="type() === 'number' && preventNegative() ? '0' : null"
      (keypress)="
        type() === 'number' || numbersOnly() ? numberValidation($event) : null
      "
      [type]="effectiveType()"
      [formControl]="$any(actualControl())"
      [placeholder]="placeholder() || label()"
      (input)="onInput($event)"
      autocomplete="new-password"
      (blur)="onBlur()"
      class="w-full px-2.5 pr-8 py-1.5 text-gray-900 bg-white border border-gray-800 dark:border-white rounded-md transition-colors disabled:bg-gray-300 disabled:cursor-not-allowed placeholder:text-gray-400"
      [ngClass]="{
        'border-red-500 dark:border-red-500 focus:ring-red-500 dark:focus:ring-red-500 focus:border-red-500 dark:focus:border-red-500':
          actualControl()?.invalid && actualControl()?.touched,
        'border-green-500 dark:border-green-500 focus:ring-green-500 dark:focus:ring-green-500 focus:border-green-500 dark:focus:border-green-500':
          wasFixedError()
      }"
    />
    }

    <!-- Textarea (cuando isTextArea es true) -->
    @if (isTextArea()) {
    <textarea
      #textarea
      [id]="id()"
      [formControl]="$any(actualControl())"
      [placeholder]="placeholder() || label()"
      (input)="onInput($event)"
      (blur)="onBlur()"
      [attr.disabled]="disabled() ? true : null"
      class="w-full px-2 py-1 custom-scroll border border-gray-800 rounded-md outline-none bg-white transition-all duration-200 resize-none text-gray-900 dark:text-gray-900"
      [class]="isTextArea() ? textAreaHeight() : ''"
      [ngClass]="{
        'border-red-500 dark:border-red-500 focus:ring-red-500 dark:focus:ring-red-500 focus:border-red-500 dark:focus:border-red-500':
          actualControl()?.invalid && actualControl()?.touched,
        'border-green-500 dark:border-green-500 focus:ring-green-500 dark:focus:ring-green-500 focus:border-green-500 dark:focus:border-green-500':
          wasFixedError(),
        'disabled:bg-gray-300 disabled:cursor-not-allowed': disabled()
      }"
    ></textarea>
    }

    <!-- Bot칩n para mostrar/ocultar contrase침a (s칩lo para inputs tipo password) -->
    @if (type() === 'password' && actualControl()?.value?.length > 0 &&
    !isTextArea()) {
    <button
      type="button"
      (click)="togglePasswordVisibility()"
      [disabled]="actualControl()?.disabled"
      class="absolute right-3 top-1/2 transform text-gray-500 hover:text-gray-700 focus:outline-none z-10"
      aria-label="Toggle password visibility"
    >
      <i
        class="pi text-base leading-none"
        [ngClass]="{
          'pi-eye': !showPassword(),
          'pi-eye-slash': showPassword()
        }"
      ></i>
    </button>
    }
  </div>

  <!-- Contenedor de errores separado -->
  @if (shouldShowError()) {
  <div class="mt-1 text-sm text-red-500 max-h-20 overflow-y-auto">
    <ul class="list-disc pl-4 space-y-1">
      @for (error of getErrorMessages(); track error) {
      <li>{{ error }}</li>
      }
    </ul>
  </div>
  }
</div>

<style>
  .custom-scroll::-webkit-scrollbar {
    width: 8px;
  }
  .custom-scroll::-webkit-scrollbar-track {
    background-color: #9ca3af;
  }
  .custom-scroll::-webkit-scrollbar-thumb {
    background-color: #9ca3af;
    border-radius: 10px;
    border: 2px solid #f1f1f1;
  }
  .custom-scroll::-webkit-scrollbar-thumb:hover {
    background-color: #9ca3af;
  }
  /* Para Firefox */
  .custom-scroll {
    scrollbar-width: thin;
    background-color: #9ca3af #f1f1f1;
  }
</style>
