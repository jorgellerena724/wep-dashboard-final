<form [formGroup]="form" class="space-y-4 max-h-[70vh] pr-4 w-[520px]">
  <!-- Usuario -->
  <div class="mb-4">
    <app-select
      [placeholder]="
        'components.chatbot_config.create.fields.user.title' | transloco
      "
      [options]="users()"
      [isSearchable]="true"
      formControlName="user_id"
      [control]="getFormControl('user_id')"
      [errorMessages]="{
        required:
          ('components.chatbot_config.create.fields.user.required' | transloco),
        userExists:
          ('components.chatbot_config.create.fields.user.exists' | transloco)
      }"
    ></app-select>
  </div>
  <div class="grid grid-cols-2 mb-4 gap-4">
    <app-select
      [placeholder]="
        'components.chatbot_config.create.fields.model.title' | transloco
      "
      [options]="models()"
      formControlName="model_id"
      [control]="getFormControl('model_id')"
      [errorMessages]="{
        required:
          ('components.chatbot_config.create.fields.model.required' | transloco)
      }"
    ></app-select>
    <app-text-field
      id="temperature"
      label="{{
        'components.chatbot_config.create.fields.temperature.title' | transloco
      }}"
      [control]="getFormControl('temperature')"
      [maxLength]="3"
      [numbersOnly]="true"
      [allowDecimals]="true"
      [errorMessages]="{
        required:
          ('components.chatbot_config.create.fields.temperature.required'
          | transloco),
        min:
          ('components.chatbot_config.create.fields.temperature.min'
          | transloco),
        max:
          ('components.chatbot_config.create.fields.temperature.max'
          | transloco)
      }"
    ></app-text-field>
  </div>

  <!-- API Key de Groq -->
  <div class="mb-4">
    <app-text-field
      id="api_key"
      label="{{
        'components.chatbot_config.create.fields.apiKey.title' | transloco
      }}"
      [control]="getFormControl('api_key')"
      [errorMessages]="{
        required:
          ('components.chatbot_config.create.fields.apiKey.required'
          | transloco),
        minlength:
          ('components.chatbot_config.create.fields.apiKey.minlength'
          | transloco)
      }"
    ></app-text-field>
  </div>

  <hr class="border-gray-500 my-4 border-opacity-10" />

  <!-- System Prompt -->
  <div class="mb-4">
    <app-text-field
      id="prompt"
      label="{{
        'components.chatbot_config.create.fields.prompt.title' | transloco
      }}"
      [control]="getFormControl('prompt')"
      [isTextArea]="true"
      textAreaHeight="h-40"
      [errorMessages]="{
        required:
          ('components.chatbot_config.create.fields.prompt.required'
          | transloco),
        minlength:
          ('components.chatbot_config.create.fields.prompt.minlength'
          | transloco)
      }"
    ></app-text-field>
  </div>

  <!-- Loading State -->
  @if (uploading()) {
  <div class="flex items-center justify-center p-4">
    <div
      class="animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500 mr-3"
    ></div>
    <span class="text-gray-600">{{ "common.saving" | transloco }}</span>
  </div>
  }
</form>

<style>
  :host ::ng-deep app-select label,
  :host ::ng-deep app-text-field label {
    font-weight: 600 !important;
    color: #1f2937 !important;
    font-size: 14px;
  }

  :host ::ng-deep .dark app-select label,
  :host ::ng-deep .dark app-text-field label {
    color: #f3f4f6 !important;
  }
</style>
